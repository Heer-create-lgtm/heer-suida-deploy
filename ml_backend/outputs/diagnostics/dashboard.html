<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARIMA Enrollment Forecast Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e5e5e5;
            min-height: 100vh;
            padding: 20px;
        }
        .dashboard-header {
            text-align: center;
            padding: 20px;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }
        .dashboard-header h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, #36A2EB, #FF6384);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .controls {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .control-group label {
            font-size: 0.85rem;
            color: #aaa;
        }
        select, input[type="range"] {
            padding: 8px 12px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 6px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 1rem;
            min-width: 180px;
        }
        .toggle-group {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        .toggle-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }
        .chart-container {
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        @media (max-width: 1200px) {
            .grid { grid-template-columns: 1fr; }
        }
        .summary-section {
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 20px;
            overflow-x: auto;
        }
        .summary-section h2 {
            margin-bottom: 15px;
            color: #36A2EB;
        }
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        .summary-table th, .summary-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .summary-table th {
            background: rgba(54, 162, 235, 0.2);
            color: #36A2EB;
            cursor: pointer;
        }
        .summary-table th:hover {
            background: rgba(54, 162, 235, 0.3);
        }
        .summary-table tr:hover {
            background: rgba(255,255,255,0.05);
        }
        .metrics-cards {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .metric-card {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 15px 20px;
            min-width: 150px;
        }
        .metric-card .value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #36A2EB;
        }
        .metric-card .label {
            font-size: 0.8rem;
            color: #aaa;
        }
    </style>
</head>
<body>
    <div class="dashboard-header">
        <h1>ðŸ“Š ARIMA Enrollment Forecast Dashboard</h1>
        <p>Interactive visualization and diagnostics for district-level forecasting</p>
    </div>
    
    <div class="controls">
        <div class="control-group">
            <label>District</label>
            <select id="districtSelect" onchange="updateCharts()">
                <option value="Mumbai">Mumbai</option><option value="Delhi">Delhi</option><option value="Bangalore">Bangalore</option><option value="Chennai">Chennai</option><option value="Kolkata">Kolkata</option><option value="Hyderabad">Hyderabad</option><option value="Pune">Pune</option><option value="Ahmedabad">Ahmedabad</option><option value="Jaipur">Jaipur</option><option value="Lucknow">Lucknow</option>
            </select>
        </div>
        <div class="control-group">
            <label>Forecast Horizon: <span id="horizonValue">24</span> periods</label>
            <input type="range" id="horizonSlider" min="6" max="36" value="24" onchange="updateHorizon()">
        </div>
        <div class="control-group">
            <label>Toggle Series</label>
            <div class="toggle-group">
                <label><input type="checkbox" id="showActual" checked onchange="updateCharts()"> Historical</label>
                <label><input type="checkbox" id="showFitted" checked onchange="updateCharts()"> Fitted</label>
                <label><input type="checkbox" id="showForecast" checked onchange="updateCharts()"> Forecast</label>
            </div>
        </div>
    </div>
    
    <div class="metrics-cards" id="metricsCards"></div>
    
    <div class="grid">
        <div class="chart-container">
            <div id="forecastChart"></div>
        </div>
        <div class="chart-container">
            <div id="diagnosticsChart"></div>
        </div>
    </div>
    
    <div class="summary-section">
        <h2>Cross-District Summary</h2>
        <table class="dataframe summary-table">
  <thead>
    <tr style="text-align: right;">
      <th>District</th>
      <th>RMSE</th>
      <th>MAE</th>
      <th>MAPE (%)</th>
      <th>AIC</th>
      <th>BIC</th>
      <th>ADF p-value</th>
      <th>Ljung-Box p-value</th>
      <th>CI Coverage (%)</th>
      <th>Data Points</th>
      <th>Order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Pune</td>
      <td>138.1</td>
      <td>74.2</td>
      <td>7.8</td>
      <td>269.0</td>
      <td>272.5</td>
      <td>0.0000</td>
      <td>0.9965</td>
      <td>96.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
    <tr>
      <td>Jaipur</td>
      <td>141.2</td>
      <td>88.2</td>
      <td>9.6</td>
      <td>284.2</td>
      <td>287.7</td>
      <td>0.0465</td>
      <td>0.9600</td>
      <td>100.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
    <tr>
      <td>Delhi</td>
      <td>168.4</td>
      <td>94.0</td>
      <td>8.9</td>
      <td>287.7</td>
      <td>291.3</td>
      <td>0.1798</td>
      <td>0.9777</td>
      <td>96.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
    <tr>
      <td>Ahmedabad</td>
      <td>193.1</td>
      <td>107.7</td>
      <td>7.8</td>
      <td>292.3</td>
      <td>295.8</td>
      <td>0.3608</td>
      <td>0.9494</td>
      <td>92.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
    <tr>
      <td>Bangalore</td>
      <td>234.2</td>
      <td>110.0</td>
      <td>7.7</td>
      <td>289.1</td>
      <td>292.7</td>
      <td>0.2933</td>
      <td>0.9717</td>
      <td>92.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
    <tr>
      <td>Lucknow</td>
      <td>240.4</td>
      <td>105.5</td>
      <td>6.6</td>
      <td>280.0</td>
      <td>283.5</td>
      <td>0.0000</td>
      <td>0.9992</td>
      <td>100.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
    <tr>
      <td>Kolkata</td>
      <td>341.6</td>
      <td>124.5</td>
      <td>6.0</td>
      <td>278.5</td>
      <td>282.0</td>
      <td>0.0132</td>
      <td>0.9999</td>
      <td>96.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
    <tr>
      <td>Mumbai</td>
      <td>344.5</td>
      <td>146.9</td>
      <td>6.3</td>
      <td>295.4</td>
      <td>299.0</td>
      <td>0.1156</td>
      <td>0.9986</td>
      <td>96.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
    <tr>
      <td>Hyderabad</td>
      <td>351.1</td>
      <td>120.9</td>
      <td>5.9</td>
      <td>279.5</td>
      <td>283.1</td>
      <td>0.0000</td>
      <td>0.9999</td>
      <td>96.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
    <tr>
      <td>Chennai</td>
      <td>365.4</td>
      <td>133.0</td>
      <td>6.4</td>
      <td>282.6</td>
      <td>286.1</td>
      <td>0.1441</td>
      <td>0.9998</td>
      <td>96.0</td>
      <td>25</td>
      <td>(1, 1, 1)</td>
    </tr>
  </tbody>
</table>
    </div>
    
    <script>
        const allData = {"Mumbai": {"actual": [[1651], [1841], [2151], [2417], [2584], [2691], [2921], [2977], [3075], [3346], [3637], [3737], [3950], [4340], [4623], [4790], [5006], [5180], [5351], [5487], [5690], [5730], [6002], [6380], [6544]], "fitted": [0.0, 1712.4122007980238, 2007.2947825920533, 2381.852211195523, 2658.7471981329218, 2808.058140974624, 2892.656024853442, 3127.208911657486, 3162.4161590253675, 3249.7854892902064, 3531.21819132869, 3832.5677383493207, 3924.048689077707, 4139.172620166159, 4544.370740832486, 4832.903531613543, 4997.081758143094, 5213.631762708495, 5385.675745919494, 5554.769259788728, 5687.2366592752705, 5890.373192672637, 5922.797991823343, 6198.371101878577, 6584.214863294401], "forecast": [6746.54887988028, 6949.097350019888, 7151.645410419654, 7354.193061080406, 7556.740302002972, 7759.287133188183, 7961.833554636867, 8164.379566349853, 8366.925168327969, 8569.470360572044, 8772.015143082908, 8974.559515861389, 9177.103478908315, 9379.647032224517, 9582.190175810822, 9784.73290966806, 9987.27523379706, 10189.81714819865, 10392.35865287366, 10594.899747822916, 10797.44043304725, 10999.98070854749, 11202.520574324462, 11405.060030379], "lower": [6562.379134187703, 6683.5100831773025, 6820.200848032369, 6964.479839855483, 7113.343773404302, 7265.294265894963, 7419.4655950809465, 7575.309258083874, 7732.454821368498, 7890.640059636979, 8049.672501667272, 8209.406747965095, 8369.73034836349, 8530.554618325263, 8691.808449205104, 8853.43400935607, 9015.383681266097, 9177.617830803494, 9340.10315107609, 9502.811412001916, 9665.71850199786, 9828.803683685119, 9992.049008847789, 10155.43885356323], "upper": [6930.718625572857, 7214.684616862473, 7483.089972806938, 7743.906282305328, 8000.136830601643, 8253.280000481403, 8504.201514192788, 8753.449874615832, 9001.395515287439, 9248.30066150711, 9494.357784498545, 9739.712283757683, 9984.47660945314, 10228.73944612377, 10472.57190241654, 10716.031809980052, 10959.166786328022, 11202.016465593806, 11444.61415467123, 11686.988083643915, 11929.162364096639, 12171.15773340986, 12412.992139801136, 12654.68120719477], "metrics": {"district": "Mumbai", "rmse": 344.48457539621035, "mae": 146.85072171529774, "mape": 6.311292119671908, "aic": 295.42888780397067, "bic": 298.9630492950145, "ci_coverage_95": 96.0, "data_points": 25, "mean_enrollment": 4084.04, "std_enrollment": 1484.7174950137821}, "diagnostics": {"district": "Mumbai", "adf_statistic": -2.4993719393721823, "adf_pvalue": 0.11562721348778243, "adf_critical_1pct": -3.9644434814814815, "adf_critical_5pct": -3.0849081481481484, "is_stationary": false, "ljung_box_pvalue": 0.9985557798182393, "no_autocorrelation": true, "shapiro_pvalue": 1.990987122248523e-08, "residual_mean": 74.48540138433624, "residual_std": 343.27095054192984, "residual_skewness": 4.331708466286953, "residual_kurtosis": 20.437369278581095, "model_order": [1, 1, 1], "aic": 295.42888780397067, "bic": 298.9630492950145, "ar_coefficients": [0.9999979770775738], "ma_coefficients": [-0.9956973768264279]}, "order": "(1, 1, 1)"}, "Delhi": {"actual": [[727], [841], [847], [1090], [1023], [1114], [1110], [1131], [1130], [1194], [1207], [1347], [1357], [1514], [1626], [1613], [1682], [1712], [1666], [1713], [1747], [1796], [1927], [1823], [2007]], "fitted": [0.0, 728.8624405133695, 874.0872197773621, 874.1873623937545, 1155.7854371081455, 1068.6392569156574, 1165.6145452157964, 1155.1406886028906, 1173.6233963252228, 1168.5040947422651, 1234.7036853599282, 1245.5030057309314, 1392.9716762681787, 1400.505747687991, 1564.7863409188176, 1680.4764674283049, 1663.6393728462733, 1733.6270254468416, 1762.5224762938508, 1711.832840777637, 1758.8866984524443, 1792.3600545769286, 1841.5142091308314, 1975.9923171718303, 1866.0098921557299], "forecast": [2055.315560395385, 2103.63088559729, 2151.9459756068604, 2200.2608304252403, 2248.575450053575, 2296.889834493009, 2345.2039837446873, 2393.517897809755, 2441.831576689357, 2490.145020384638, 2538.4582288967426, 2586.771202226816, 2635.083940376003, 2683.396443345448, 2731.708711136296, 2780.0207437496924, 2828.3325411867813, 2876.644103448708, 2924.955430536617, 2973.2665224516527, 3021.5773791949605, 3069.8880007676853, 3118.1983871709713, 3166.5085384059635], "lower": [1892.104559531986, 1868.6667949443647, 1859.1814892762873, 1856.5360020285905, 1858.0432123741639, 1862.3587968714473, 1868.703926251644, 1876.583820549017, 1885.6634419091506, 1895.7050051739948, 1906.5335355942711, 1918.0165250367622, 1930.0512477943903, 1942.556500314815, 1955.4670257369462, 1968.7296359233214, 1982.300444402052, 1996.1428480575646, 2010.2260264830693, 2024.5238072714117, 2039.0137951056647, 2053.676694355035, 2068.495775837244, 2083.4564525017404], "upper": [2218.526561258784, 2338.5949762502155, 2444.7104619374336, 2543.9856588218904, 2639.107687732986, 2731.4208721145706, 2821.7040412377305, 2910.451975070493, 2997.9997114695634, 3084.585035595281, 3170.382922199214, 3255.52587941687, 3340.1166329576154, 3424.236386376081, 3507.950396535646, 3591.3118515760634, 3674.3646379715105, 3757.1453588398513, 3839.6848345901644, 3922.0092376318935, 4004.140963284256, 4086.0993071803355, 4167.900998504699, 4249.5606243101865], "metrics": {"district": "Delhi", "rmse": 168.37401782140915, "mae": 93.96348060242435, "mape": 8.936090071687657, "aic": 287.7460773943383, "bic": 291.2802388853821, "ci_coverage_95": 96.0, "data_points": 25, "mean_enrollment": 1397.76, "std_enrollment": 368.67943166568614}, "diagnostics": {"district": "Delhi", "adf_statistic": -2.275997961098604, "adf_pvalue": 0.17982598362718477, "adf_critical_1pct": -3.859073285322359, "adf_critical_5pct": -3.0420456927297668, "is_stationary": false, "ljung_box_pvalue": 0.9776950173715075, "no_autocorrelation": true, "shapiro_pvalue": 6.992852733061701e-06, "residual_mean": 38.16894992636068, "residual_std": 167.3722807186472, "residual_skewness": 3.053427977901096, "residual_kurtosis": 12.217631099949774, "model_order": [1, 1, 1], "aic": 287.7460773943383, "bic": 291.2802388853821, "ar_coefficients": [0.9999951321380095], "ma_coefficients": [-0.9980610605005388]}, "order": "(1, 1, 1)"}, "Bangalore": {"actual": [[1087], [1153], [1162], [1404], [1347], [1361], [1480], [1457], [1497], [1563], [1677], [1811], [1931], [1971], [2261], [2270], [2291], [2431], [2441], [2480], [2611], [2560], [2645], [2770], [2830]], "fitted": [0.0, 1092.35869376913, 1183.6565709739561, 1186.2813579560052, 1477.7961401916225, 1396.560554475394, 1405.0011908583165, 1534.14064279203, 1501.9528809318151, 1541.4255249734938, 1609.5007079468126, 1729.4242403617245, 1870.005928657179, 1994.559845837465, 2032.9224973990126, 2337.7416069668907, 2342.607854343997, 2360.639344679159, 2504.46602176682, 2511.1913513466247, 2548.660560083726, 2682.5763011785048, 2626.0976322458123, 2711.906085822309, 2839.2897948699765], "forecast": [2898.9231934905333, 2967.8460478572624, 3036.7685631018553, 3105.690739225981, 3174.6125762313077, 3243.534074119504, 3312.4552328922387, 3381.3760525511802, 3450.2965330979973, 3519.2166745343584, 3588.136476861932, 3657.0559400823863, 3725.97506419739, 3794.893849208612, 3863.8122951177206, 3932.7304019263843, 4001.648169636271, 4070.5655982490503, 4139.48268776639, 4208.399438189958, 4277.315849521424, 4346.231921762455, 4415.147654914721, 4484.06304897989], "lower": [2732.5156775828377, 2728.0875156679263, 2737.8063190552007, 2754.4435096095694, 2775.2717709848284, 2798.928454767643, 2824.6251430968646, 2851.861610722868, 2880.2995632312172, 2909.6992036811116, 2939.884292090057, 2970.7215207842632, 3002.10766368612, 3033.9612133087503, 3066.2167398650404, 3098.8209705469753, 3131.7299939421314, 3164.9072223679955, 3198.321877911882, 3231.947848470194, 3265.762810360911, 3299.7475463620376, 3333.885409262258, 3368.1618952846225], "upper": [3065.330709398229, 3207.6045800465986, 3335.73080714851, 3456.9379688423924, 3573.953381477787, 3688.1396934713653, 3800.2853226876127, 3910.8904943794923, 4020.2935029647774, 4128.734145387605, 4236.388661633807, 4343.39035938051, 4449.84246470866, 4555.826485108474, 4661.4078503704, 4766.639833305793, 4871.566345330411, 4976.2239741301055, 5080.643497620898, 5184.851027909723, 5288.868888681936, 5392.716297162873, 5496.409900567184, 5599.964202675157], "metrics": {"district": "Bangalore", "rmse": 234.17884755245026, "mae": 109.97263203689664, "mape": 7.692080631932797, "aic": 289.1364542954939, "bic": 292.6706157865377, "ci_coverage_95": 92.0, "data_points": 25, "mean_enrollment": 1939.64, "std_enrollment": 567.4524121016669}, "diagnostics": {"district": "Bangalore", "adf_statistic": -1.9847407552801262, "adf_pvalue": 0.2933035632607742, "adf_critical_1pct": -3.859073285322359, "adf_critical_5pct": -3.0420456927297668, "is_stationary": false, "ljung_box_pvalue": 0.9716856086060277, "no_autocorrelation": true, "shapiro_pvalue": 1.0668511264766563e-07, "residual_mean": 58.80946678288892, "residual_std": 231.34835579008796, "residual_skewness": 3.9210755170829255, "residual_kurtosis": 17.562285005749686, "model_order": [1, 1, 1], "aic": 289.1364542954939, "bic": 292.6706157865377, "ar_coefficients": [0.9999950796852639], "ma_coefficients": [-0.9973429603509867]}, "order": "(1, 1, 1)"}, "Chennai": {"actual": [[1785], [1830], [2073], [2053], [2165], [2204], [2210], [2184], [2293], [2404], [2463], [2554], [2670], [2864], [2947], [3076], [3052], [3180], [3217], [3180], [3200], [3294], [3424], [3486], [3657]], "fitted": [0.0, 1795.316449297519, 1858.6079808971253, 2175.6346035533115, 2124.158357017235, 2244.499934109944, 2276.630732813568, 2272.96819895918, 2235.7001653508323, 2351.1415235654763, 2467.4832518123862, 2526.071632241233, 2619.419547474192, 2739.3422661352474, 2942.3147090656307, 3025.629173404931, 3157.7986798872157, 3127.5347754954046, 3258.467374223481, 3293.2718244622374, 3250.5758695264494, 3268.1541379519804, 3363.335074866619, 3495.9861917002045, 3557.5678702618447], "forecast": [3732.5646336880045, 3808.129128481263, 3883.6934843800304, 3959.2577013845626, 4034.8217794951142, 4110.385718711941, 4185.949519035298, 4261.513180465441, 4337.076703002625, 4412.640086647106, 4488.203331399138, 4563.766437258977, 4639.329404226878, 4714.8922323030965, 4790.454921487888, 4866.017471781507, 4941.57988318421, 5017.142155696252, 5092.704289317888, 5168.266284049372, 5243.828139890961, 5319.38985684291, 5394.951434905474, 5470.51287407891], "lower": [3588.3296317353943, 3600.245563480096, 3624.3950489818335, 3654.521425292511, 3688.2654480462093, 3724.44904842531, 3762.3909965749817, 3801.6593205648796, 3841.9620484136967, 3883.0923321580062, 3924.898229418295, 3967.264871248926, 4010.1033546611484, 4053.3435162745754, 4096.929059609161, 4140.814169348547, 4184.961097973402, 4229.338407243535, 4273.91966205348, 4318.6824438098565, 4363.60759395531, 4408.678626170242, 4453.881264137709, 4499.203074093572], "upper": [3876.7996356406147, 4016.0126934824298, 4142.991919778227, 4263.993977476614, 4381.37811094402, 4496.322388998572, 4609.508041495615, 4721.367040366003, 4832.191357591554, 4942.187841136205, 5051.5084333799805, 5160.268003269029, 5268.555453792608, 5376.440948331618, 5483.980783366615, 5591.220774214467, 5698.198668395019, 5804.94590414897, 5911.488916582295, 6017.850124288888, 6124.048685826612, 6230.101087515579, 6336.02160567324, 6441.822674064248], "metrics": {"district": "Chennai", "rmse": 365.3501083777042, "mae": 133.04091992090827, "mape": 6.405994435042272, "aic": 282.57588004828983, "bic": 286.1100415393337, "ci_coverage_95": 96.0, "data_points": 25, "mean_enrollment": 2698.6, "std_enrollment": 559.6871149728807}, "diagnostics": {"district": "Chennai", "adf_statistic": -2.3918480966071627, "adf_pvalue": 0.14405045460212718, "adf_critical_1pct": -3.889265672705068, "adf_critical_5pct": -3.0543579727254224, "is_stationary": false, "ljung_box_pvalue": 0.9997854689970662, "no_autocorrelation": true, "shapiro_pvalue": 3.789617399883978e-09, "residual_mean": 81.49558703707004, "residual_std": 363.4888395023915, "residual_skewness": 4.62723741225829, "residual_kurtosis": 22.426655847534484, "model_order": [1, 1, 1], "aic": 282.57588004828983, "bic": 286.1100415393337, "ar_coefficients": [0.9999981619080341], "ma_coefficients": [-0.9979707914395929]}, "order": "(1, 1, 1)"}, "Kolkata": {"actual": [[1672], [1784], [2000], [2190], [2247], [2337], [2376], [2547], [2712], [2764], [2897], [3065], [3357], [3523], [3677], [3772], [3847], [4093], [4150], [4305], [4373], [4537], [4650], [4773], [4960]], "fitted": [0.0, 1701.5349279297345, 1880.2725313563612, 2149.826502940573, 2352.2424664182004, 2384.3927245124623, 2465.338845355966, 2490.0076569641933, 2668.886756433709, 2839.1238795433064, 2882.9842023288065, 3017.354222838702, 3189.598568794866, 3495.29571155139, 3663.3913430921943, 3818.3484079785235, 3910.30011883969, 3981.3924276932944, 4233.883248427224, 4286.270146031712, 4442.246420945143, 4506.812229388855, 4672.238761897953, 4784.234006146562, 4906.747878606957], "forecast": [5095.955708472866, 5231.910981471681, 5367.865818997841, 5503.8202210527415, 5639.774187637776, 5775.72771875434, 5911.680814403828, 6047.633474587635, 6183.585699307156, 6319.537488563785, 6455.488842358917, 6591.439760693948, 6727.390243570272, 6863.340290989284, 6999.289902952379, 7135.239079460951, 7271.187820516395, 7407.136126120106, 7543.083996273479, 7679.031430977909, 7814.97843023479, 7950.9249940455165, 8086.871122411484, 8222.816815334087], "lower": [4966.633831314559, 5045.413294948326, 5135.115752562106, 5230.144056817483, 5328.389519869558, 5428.800097084205, 5530.767951885561, 5633.90797420509, 5737.9600794678045, 5842.740157542102, 5948.113073365944, 6053.976741331651, 6160.252209778824, 6266.8772130321495, 6373.801825539299, 6480.985443591889, 6588.394634874351, 6696.001572242563, 6803.782870942003, 6911.71871067778, 7019.7921627816795, 7127.9886676409615, 7236.295623939097, 7344.702062269282], "upper": [5225.277585631173, 5418.408667995036, 5600.615885433577, 5777.496385288, 5951.158855405994, 6122.655340424474, 6292.593676922094, 6461.35897497018, 6629.211319146507, 6796.334819585468, 6962.864611351891, 7128.902780056245, 7294.52827736172, 7459.803368946418, 7624.7779803654585, 7789.492715330013, 7953.9810061584385, 8118.2706799976495, 8282.385121604955, 8446.344151278037, 8610.1646976879, 8773.86132045007, 8937.446620883871, 9100.931568398892], "metrics": {"district": "Kolkata", "rmse": 341.5840161017342, "mae": 124.47895096454732, "mape": 5.989404529192759, "aic": 278.50723087169274, "bic": 282.0413923627366, "ci_coverage_95": 96.0, "data_points": 25, "mean_enrollment": 3304.32, "std_enrollment": 1014.1850472177156}, "diagnostics": {"district": "Kolkata", "adf_statistic": -3.340478849015807, "adf_pvalue": 0.013163224947290547, "adf_critical_1pct": -3.9240193847656246, "adf_critical_5pct": -3.0684982031250003, "is_stationary": true, "ljung_box_pvalue": 0.9999492168966464, "no_autocorrelation": true, "shapiro_pvalue": 3.360271320959281e-09, "residual_mean": 75.41104055934487, "residual_std": 340.025757323904, "residual_skewness": 4.655429196152374, "residual_kurtosis": 22.62113708728777, "model_order": [1, 1, 1], "aic": 278.50723087169274, "bic": 282.0413923627366, "ar_coefficients": [0.9999967969417766], "ma_coefficients": [-0.9947532938845014]}, "order": "(1, 1, 1)"}, "Hyderabad": {"actual": [[1716], [1866], [1927], [2210], [2223], [2343], [2447], [2481], [2575], [2716], [2843], [3041], [3150], [3397], [3521], [3635], [3807], [3936], [4041], [4041], [4164], [4230], [4417], [4596], [4715]], "fitted": [0.0, 1741.328234856124, 1987.4287765118981, 2022.1244173382606, 2362.103367239812, 2342.7327508592366, 2462.7831122295265, 2564.2765735855346, 2586.863746524705, 2679.4337047427753, 2824.367090513766, 2953.1767713811596, 3158.9519260982433, 3267.2237191468585, 3523.985760328859, 3647.77676737024, 3760.941148407889, 3935.768353893674, 4064.7816549958343, 4168.481154206861, 4161.871093655991, 4284.9759558389005, 4348.392679879616, 4538.471921930695, 4719.943241484957], "forecast": [4838.739510226765, 4962.478927197698, 5086.218250912871, 5209.957481372353, 5333.696618576216, 5457.435662524528, 5581.174613217361, 5704.913470654786, 5828.652234836871, 5952.390905763687, 6076.129483435306, 6199.867967851796, 6323.606359013228, 6447.344656919673, 6571.082861571201, 6694.820972967881, 6818.558991109785, 6942.2969159969825, 7066.034747629544, 7189.77248600754, 7313.51013113104, 7437.247683000115, 7560.985141614835, 7684.72250697527], "lower": [4705.964967570685, 4771.028125413775, 4847.318351213025, 4929.086500326109, 5014.166309602483, 5101.476866804563, 5190.3935788988165, 5280.5206725927, 5371.590831808973, 5463.414807011392, 5555.85367659678, 5648.802484153355, 5742.180050120904, 5835.922345975475, 5929.978028207906, 6024.305336394451, 6118.869883008152, 6213.643043589938, 6308.6007615195385, 6403.722645533249, 6498.9912780341, 6594.391677844268, 6689.910877886012, 6785.53758959143], "upper": [4971.514052882844, 5153.92972898162, 5325.118150612716, 5490.828462418597, 5653.226927549948, 5813.394458244494, 5971.955647535906, 6129.306268716871, 6285.713637864768, 6441.367004515982, 6596.405290273831, 6750.933451550236, 6905.032667905552, 7058.766967863871, 7212.187694934495, 7365.336609541311, 7518.248099211418, 7670.950788404027, 7823.468733739549, 7975.82232648183, 8128.02898422798, 8280.103688155961, 8432.059405343658, 8583.907424359111], "metrics": {"district": "Hyderabad", "rmse": 351.13075695471514, "mae": 120.90080599237307, "mape": 5.907979029649257, "aic": 279.54748577687235, "bic": 283.0816472679162, "ci_coverage_95": 96.0, "data_points": 25, "mean_enrollment": 3201.52, "std_enrollment": 924.359017553966}, "diagnostics": {"district": "Hyderabad", "adf_statistic": -21.276971309361418, "adf_pvalue": 0.0, "adf_critical_1pct": -3.7377092158564813, "adf_critical_5pct": -2.9922162731481485, "is_stationary": true, "ljung_box_pvalue": 0.9998583493500225, "no_autocorrelation": true, "shapiro_pvalue": 3.825813725018575e-09, "residual_mean": 77.1926430791433, "residual_std": 349.60409801369013, "residual_skewness": 4.630326948788835, "residual_kurtosis": 22.45032440354281, "model_order": [1, 1, 1], "aic": 279.54748577687235, "bic": 283.0816472679162, "ar_coefficients": [0.9999992463536448], "ma_coefficients": [-0.9977341314570874]}, "order": "(1, 1, 1)"}, "Pune": {"actual": [[631], [700], [794], [856], [891], [907], [925], [986], [1002], [1001], [1101], [1207], [1310], [1446], [1603], [1547], [1657], [1663], [1760], [1787], [1780], [1864], [1956], [1937], [2040]], "fitted": [0.0, 633.0864875110044, 737.5977723064651, 851.1527244301658, 914.4005181651071, 944.6093047625893, 954.2174790625572, 967.973063856626, 1031.2595673928167, 1043.9657280167326, 1038.6182020307563, 1144.350391079458, 1255.6229539090612, 1362.8442474329254, 1504.8349897424384, 1668.4322081915752, 1604.7843746769258, 1717.8781248452838, 1720.8079708178084, 1819.8843507880267, 1845.2294056412038, 1835.103760546603, 1920.4250364506006, 2013.9807520706922, 1991.7546077811458], "forecast": [2096.6951926256024, 2153.3902497075483, 2210.0851712461613, 2266.7799572417653, 2323.474607694685, 2380.1691226052435, 2436.863501973766, 2493.5577458005755, 2550.2518540859965, 2606.9458268303533, 2663.6396640339694, 2720.3333656971695, 2777.0269318202772, 2833.7203624036165, 2890.4136574475115, 2947.1068169522864, 3003.799840918265, 3060.4927293457717, 3117.18548223513, 3173.8780995866646, 3230.570581400699, 3287.262927677558, 3343.9551384175643, 3400.647213621043], "lower": [1988.442547924052, 1997.3653463641012, 2015.4688259255283, 2038.057406926918, 2063.3605256807355, 2090.494081373973, 2118.9468426101735, 2148.394639785366, 2178.618368515359, 2209.462806368383, 2240.8139347405427, 2272.5855564213857, 2304.7109598756406, 2337.137496204923, 2369.822922439588, 2402.732860746051, 2435.838987355659, 2469.117712925653, 2502.5492023819297, 2536.116634543864, 2569.8056344591655, 2603.60383231954, 2637.500516601963, 2671.486358338585], "upper": [2204.947837327153, 2309.4151530509953, 2404.7015165667945, 2495.5025075566127, 2583.5886897086343, 2669.844163836514, 2754.780161337358, 2838.720851815785, 2921.8853396566337, 3004.4288472923236, 3086.465393327396, 3168.0811749729532, 3249.342903764914, 3330.30322860231, 3411.0043924554348, 3491.480773158522, 3571.7606944808713, 3651.8677457658905, 3731.8217620883306, 3811.639564629465, 3891.335528342233, 3970.922023035576, 4050.4097602331653, 4129.808068903501], "metrics": {"district": "Pune", "rmse": 138.08995734979143, "mae": 74.23603425458401, "mape": 7.792940743786579, "aic": 268.98408090621035, "bic": 272.5182423972542, "ci_coverage_95": 96.0, "data_points": 25, "mean_enrollment": 1334.04, "std_enrollment": 448.7757866314388}, "diagnostics": {"district": "Pune", "adf_statistic": -10.722541135815405, "adf_pvalue": 3.124150880228398e-19, "adf_critical_1pct": -3.7377092158564813, "adf_critical_5pct": -2.9922162731481485, "is_stationary": true, "ljung_box_pvalue": 0.9964820751177048, "no_autocorrelation": true, "shapiro_pvalue": 4.106244428208292e-07, "residual_mean": 33.12743913965724, "residual_std": 136.8218469736723, "residual_skewness": 3.6389582014927413, "residual_kurtosis": 16.255204631940785, "model_order": [1, 1, 1], "aic": 268.98408090621035, "bic": 272.5182423972542, "ar_coefficients": [0.9999976092566133], "ma_coefficients": [-0.997673518839994]}, "order": "(1, 1, 1)"}, "Ahmedabad": {"actual": [[834], [1086], [1194], [1310], [1371], [1560], [1696], [1621], [1712], [1774], [2010], [2121], [2331], [2474], [2527], [2740], [2887], [3110], [3144], [3191], [3231], [3320], [3390], [3700], [3777]], "fitted": [0.0, 846.0934542324995, 1255.753355574759, 1339.2639109222255, 1446.9538903130253, 1491.1554829120803, 1692.623860235726, 1829.1413401779864, 1726.4663470950438, 1815.768356995004, 1873.3808133269736, 2122.3677843901073, 2233.248843159945, 2451.0575043624253, 2595.7546053588344, 2644.0178386173816, 2863.2042990415816, 3011.6451307998636, 3240.2616735167717, 3269.060616402703, 3312.058648588888, 3348.105144310032, 3435.7978000120934, 3503.7619746234236, 3822.1141753310585], "forecast": [3897.2718962181466, 4017.543580415956, 4137.815052593803, 4258.08631275206, 4378.357360891101, 4498.6281970113005, 4618.898821113031, 4739.169233196667, 4859.4394332625825, 4979.709421311151, 5099.979197342746, 5220.248761357742, 5340.518113356512, 5460.78725333943, 5581.05618130687, 5701.3248972592055, 5821.59340119681, 5941.861693120058, 6062.129773029322, 6182.397640924977, 6302.665296807397, 6422.932740676954, 6543.199972534024, 6663.466992378978], "lower": [3722.698396395839, 3765.862255499704, 3823.8036891575457, 3888.9586424839617, 3958.476211002528, 4030.9334733545156, 4105.507986157702, 4181.678467700489, 4259.0927367037975, 4337.5013975983165, 4416.721331302287, 4496.6141558016125, 4577.072812624368, 4658.012842317786, 4739.366502963418, 4821.078684514015, 4903.10399723936, 4985.404650728016, 5067.948878901051, 5150.709750608878, 5233.664257901189, 5316.792607766004, 5400.077665299369, 5483.504511163728], "upper": [4071.845396040454, 4269.224905332208, 4451.82641603006, 4627.213983020158, 4798.238510779674, 4966.322920668085, 5132.289656068359, 5296.659998692845, 5459.7861298213675, 5621.917445023986, 5783.237063383206, 5943.883366913872, 6103.963414088656, 6263.561664361075, 6422.745859650322, 6581.571110004396, 6740.08280515426, 6898.318735512099, 7056.310667157592, 7214.085531241077, 7371.666335713605, 7529.072873587905, 7686.3222797686785, 7843.429473594228], "metrics": {"district": "Ahmedabad", "rmse": 193.0666124878135, "mae": 107.7471379070653, "mape": 7.783763487834359, "aic": 292.31156769440895, "bic": 295.8457291854528, "ci_coverage_95": 92.0, "data_points": 25, "mean_enrollment": 2324.44, "std_enrollment": 885.2131607697662}, "diagnostics": {"district": "Ahmedabad", "adf_statistic": -1.8399351701044977, "adf_pvalue": 0.36082286715733447, "adf_critical_1pct": -3.9240193847656246, "adf_critical_5pct": -3.0684982031250003, "is_stationary": false, "ljung_box_pvalue": 0.9494116848085782, "no_autocorrelation": true, "shapiro_pvalue": 4.450287962944572e-06, "residual_mean": 37.6777259879827, "residual_std": 193.25907110527297, "residual_skewness": 3.088608393906852, "residual_kurtosis": 12.297079594602232, "model_order": [1, 1, 1], "aic": 292.31156769440895, "bic": 295.8457291854528, "ar_coefficients": [0.9999982371581084], "ma_coefficients": [-0.9973846618746024]}, "order": "(1, 1, 1)"}, "Jaipur": {"actual": [[586], [693], [780], [956], [871], [957], [967], [991], [980], [1013], [991], [1136], [1323], [1465], [1390], [1526], [1553], [1597], [1670], [1654], [1622], [1664], [1760], [1880], [1885]], "fitted": [0.0, 587.5742716513079, 728.3840920137524, 827.917504537277, 1028.9423930599844, 918.1260467244367, 1009.587164323137, 1014.3405627085499, 1035.7802167710922, 1019.2663558693591, 1051.7023797343682, 1024.6919094374205, 1178.1787799888027, 1375.4392899302566, 1523.365029141724, 1440.0870615386616, 1581.1078801605934, 1606.5553024003946, 1650.0548248504545, 1724.0465340022045, 1704.7267439211835, 1668.983006048004, 1710.7669328128945, 1808.8100361331506, 1931.6470933184125], "forecast": [1934.858537589067, 1984.7167287534633, 2034.5745734955958, 2084.4320718178715, 2134.2892237226974, 2184.1460292124802, 2234.0024882896273, 2283.8586009565456, 2333.7143672156417, 2383.5697870693225, 2433.424860519995, 2483.2795875700663, 2533.1339682219427, 2582.9880024780314, 2632.841690340739, 2682.695031812473, 2732.5480268956394, 2782.4006755926453, 2832.2529779058973, 2882.104933837802, 2931.9565433907665, 2981.807806567197, 3031.6587233695004, 3081.5092938000835], "lower": [1783.7702468599286, 1767.1361807912347, 1763.3899060404397, 1765.9553651058352, 1772.3494283129385, 1781.3304556676899, 1792.179470376708, 1804.4399444872363, 1817.8028947793052, 1832.049133896904, 1847.0174486683334, 1862.5858089374065, 1878.6596544465215, 1895.1642689644468, 1912.039634405444, 1929.2368526258097, 1946.7155929564194, 1964.4422309294532, 1982.3884647713596, 2000.5302695573087, 2018.847094726672, 2037.3212400712353, 2055.93736466014, 2074.6820961785447], "upper": [2085.9468283182055, 2202.2972767156916, 2305.759240950752, 2402.9087785299075, 2496.2290191324564, 2586.9616027572706, 2675.8255062025464, 2763.277257425855, 2849.625839651978, 2935.090440241741, 3019.8322723716565, 3103.973366202726, 3187.608281997364, 3270.811735991616, 3353.643746276034, 3436.1532109991367, 3518.380460834859, 3600.3591202558373, 3682.117491040435, 3763.6795981182954, 3845.065992054861, 3926.2943730631587, 4007.380082078861, 4088.336491421622], "metrics": {"district": "Jaipur", "rmse": 141.20962709800696, "mae": 88.1607964736237, "mape": 9.639892635794283, "aic": 284.21571223878766, "bic": 287.7498737298315, "ci_coverage_95": 100.0, "data_points": 25, "mean_enrollment": 1276.4, "std_enrollment": 392.43003622726604}, "diagnostics": {"district": "Jaipur", "adf_statistic": -2.8902813199045334, "adf_pvalue": 0.046489876197860956, "adf_critical_1pct": -3.9240193847656246, "adf_critical_5pct": -3.0684982031250003, "is_stationary": true, "ljung_box_pvalue": 0.9599715363277047, "no_autocorrelation": true, "shapiro_pvalue": 6.215903931664274e-05, "residual_mean": 30.396743556903115, "residual_std": 140.7428090462279, "residual_skewness": 2.5840718365156454, "residual_kurtosis": 9.968329235693076, "model_order": [1, 1, 1], "aic": 284.21571223878766, "bic": 287.7498737298315, "ar_coefficients": [0.9999930518485391], "ma_coefficients": [-0.9974384774199178]}, "order": "(1, 1, 1)"}, "Lucknow": {"actual": [[1150], [1206], [1341], [1481], [1597], [1744], [1717], [1897], [1926], [2092], [2231], [2303], [2453], [2631], [2847], [3034], [3103], [3094], [3243], [3306], [3431], [3473], [3610], [3717], [3946]], "fitted": [0.0, 1165.0621111707737, 1251.5906663992832, 1424.784015466633, 1581.6103403645234, 1701.1555303727564, 1856.1775505180822, 1807.2274243308536, 1999.457182755802, 2019.6494689366937, 2193.3958358652244, 2336.0327279851867, 2405.119396922156, 2558.9999925151305, 2742.3982543431566, 2965.694351255816, 3157.1483572924, 3222.833217022888, 3206.400201124569, 3357.3966802234563, 3417.7376027564246, 3543.3899373984223, 3582.0890827291773, 3720.3393044200734, 3827.1960138602917], "forecast": [4061.081430251838, 4176.162757897813, 4291.243982938018, 4406.3251053725435, 4521.406125201481, 4636.487042424922, 4751.567857042958, 4866.648569055681, 4981.729178463182, 5096.809685265552, 5211.890089462883, 5326.970391055267, 5442.050590042795, 5557.130686425558, 5672.210680203649, 5787.290571377158, 5902.370359946177, 6017.450045910797, 6132.52962927111, 6247.609110027208, 6362.688488179181, 6477.767763727122, 6592.8469366711215, 6707.926007011271], "lower": [3927.1373821533607, 3983.031831673392, 4050.254732613683, 4123.005534595527, 4199.0984852897, 4277.442888743053, 4357.408464578143, 4438.595814467645, 4520.735159783153, 4603.635497830789, 4687.156613088365, 4771.192566448273, 4855.661414426879, 4940.498523034209, 5025.65206096742, 5111.079869261943, 5196.747230787667, 5282.625245575144, 5368.689624529203, 5454.919778570912, 5541.298120507868, 5627.80952276893, 5714.440891128628, 5801.180825963315], "upper": [4195.025478350315, 4369.2936841222345, 4532.233233262354, 4689.64467614956, 4843.713765113262, 4995.531196106791, 5145.727249507773, 5294.701323643717, 5442.72319714321, 5589.983872700314, 5736.623565837402, 5882.748215662261, 6028.439765658712, 6173.762849816908, 6318.769299439878, 6463.501273492373, 6607.993489104687, 6752.27484624645, 6896.369634013017, 7040.298441483504, 7184.078855850495, 7327.7260046853135, 7471.252982213615, 7614.6711880592275], "metrics": {"district": "Lucknow", "rmse": 240.38286980316684, "mae": 105.50658676811392, "mape": 6.6400707472900775, "aic": 279.96093138264973, "bic": 283.4950928736936, "ci_coverage_95": 100.0, "data_points": 25, "mean_enrollment": 2502.92, "std_enrollment": 861.4372157427764}, "diagnostics": {"district": "Lucknow", "adf_statistic": -15.812239598292713, "adf_pvalue": 1.0434125603150646e-28, "adf_critical_1pct": -3.7377092158564813, "adf_critical_5pct": -2.9922162731481485, "is_stationary": true, "ljung_box_pvalue": 0.9991937563426324, "no_autocorrelation": true, "shapiro_pvalue": 2.016943281250387e-08, "residual_mean": 61.20459015880904, "residual_std": 237.25408812402148, "residual_skewness": 4.2969692707359535, "residual_kurtosis": 20.392735002563654, "model_order": [1, 1, 1], "aic": 279.96093138264973, "bic": 283.4950928736936, "ar_coefficients": [0.9999991084064381], "ma_coefficients": [-0.9977006536862134]}, "order": "(1, 1, 1)"}};
        let currentHorizon = 24;
        
        function updateHorizon() {
            currentHorizon = parseInt(document.getElementById('horizonSlider').value);
            document.getElementById('horizonValue').textContent = currentHorizon;
            updateCharts();
        }
        
        function updateCharts() {
            const district = document.getElementById('districtSelect').value;
            const data = allData[district];
            const showActual = document.getElementById('showActual').checked;
            const showFitted = document.getElementById('showFitted').checked;
            const showForecast = document.getElementById('showForecast').checked;
            
            // Update metrics cards
            const metrics = data.metrics || {};
            document.getElementById('metricsCards').innerHTML = `
                <div class="metric-card"><div class="value">${(metrics.rmse || 0).toFixed(1)}</div><div class="label">RMSE</div></div>
                <div class="metric-card"><div class="value">${(metrics.mae || 0).toFixed(1)}</div><div class="label">MAE</div></div>
                <div class="metric-card"><div class="value">${(metrics.mape || 0).toFixed(1)}%</div><div class="label">MAPE</div></div>
                <div class="metric-card"><div class="value">${(metrics.aic || 0).toFixed(0)}</div><div class="label">AIC</div></div>
                <div class="metric-card"><div class="value">${(metrics.ci_coverage_95 || 0).toFixed(1)}%</div><div class="label">CI Coverage</div></div>
                <div class="metric-card"><div class="value">${metrics.data_points || 0}</div><div class="label">Data Points</div></div>
            `;
            
            // Build forecast chart
            const traces = [];
            const n = data.actual.length;
            const histX = [...Array(n).keys()];
            const forecastX = [...Array(currentHorizon).keys()].map(i => n + i);
            
            if (showActual) {
                traces.push({
                    x: histX, y: data.actual,
                    mode: 'lines+markers', name: 'Historical',
                    line: {color: '#36A2EB', width: 2},
                    marker: {size: 4}
                });
            }
            if (showFitted) {
                traces.push({
                    x: histX, y: data.fitted,
                    mode: 'lines', name: 'Fitted',
                    line: {color: '#4BC0C0', width: 1, dash: 'dot'},
                    opacity: 0.7
                });
            }
            if (showForecast) {
                traces.push({
                    x: forecastX, y: data.forecast.slice(0, currentHorizon),
                    mode: 'lines+markers', name: 'Forecast',
                    line: {color: '#FF6384', width: 2, dash: 'dash'},
                    marker: {size: 6}
                });
                // Confidence interval
                const lower = data.lower.slice(0, currentHorizon);
                const upper = data.upper.slice(0, currentHorizon);
                traces.push({
                    x: [...forecastX, ...forecastX.slice().reverse()],
                    y: [...upper, ...lower.slice().reverse()],
                    fill: 'toself', fillcolor: 'rgba(255, 99, 132, 0.15)',
                    line: {color: 'transparent'},
                    name: '95% CI', showlegend: true
                });
            }
            
            Plotly.newPlot('forecastChart', traces, {
                title: `Enrollment Forecast: ${district}`,
                template: 'plotly_dark',
                paper_bgcolor: 'transparent',
                plot_bgcolor: 'transparent',
                xaxis: {title: 'Period', gridcolor: 'rgba(255,255,255,0.1)'},
                yaxis: {title: 'Enrollments', gridcolor: 'rgba(255,255,255,0.1)'},
                legend: {x: 0, y: 1}
            });
            
            // Diagnostics info
            const diag = data.diagnostics || {};
            const diagText = `
                <b>Model: ARIMA${data.order}</b><br><br>
                <b>ADF Test (Stationarity)</b><br>
                Statistic: ${(diag.adf_statistic || 0).toFixed(3)}<br>
                p-value: ${(diag.adf_pvalue || 0).toFixed(4)}<br>
                Stationary: ${diag.is_stationary ? 'âœ“ Yes' : 'âœ— No'}<br><br>
                <b>Ljung-Box (Autocorrelation)</b><br>
                p-value: ${(diag.ljung_box_pvalue || 0).toFixed(4)}<br>
                No Autocorr: ${diag.no_autocorrelation ? 'âœ“ Yes' : 'âœ— No'}<br><br>
                <b>Model Coefficients</b><br>
                AR: ${(diag.ar_coefficients || []).map(c => c.toFixed(3)).join(', ') || 'N/A'}<br>
                MA: ${(diag.ma_coefficients || []).map(c => c.toFixed(3)).join(', ') || 'N/A'}<br><br>
                <b>Information Criteria</b><br>
                AIC: ${(diag.aic || 0).toFixed(1)}<br>
                BIC: ${(diag.bic || 0).toFixed(1)}
            `;
            
            Plotly.newPlot('diagnosticsChart', [{
                type: 'indicator',
                mode: 'number',
                value: 0,
                title: {text: ''}
            }], {
                title: 'Model Diagnostics',
                template: 'plotly_dark',
                paper_bgcolor: 'transparent',
                annotations: [{
                    text: diagText,
                    x: 0.5, y: 0.5,
                    xref: 'paper', yref: 'paper',
                    showarrow: false,
                    font: {size: 13, color: 'white'},
                    align: 'left'
                }]
            });
        }
        
        // Sortable table
        document.querySelectorAll('.summary-table th').forEach((th, i) => {
            th.addEventListener('click', () => sortTable(i));
        });
        
        function sortTable(col) {
            const table = document.querySelector('.summary-table');
            const rows = Array.from(table.querySelectorAll('tr:not(:first-child)'));
            const dir = table.dataset.sortDir === 'asc' ? 'desc' : 'asc';
            table.dataset.sortDir = dir;
            
            rows.sort((a, b) => {
                const aVal = a.cells[col]?.textContent || '';
                const bVal = b.cells[col]?.textContent || '';
                const aNum = parseFloat(aVal);
                const bNum = parseFloat(bVal);
                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return dir === 'asc' ? aNum - bNum : bNum - aNum;
                }
                return dir === 'asc' ? aVal.localeCompare(bVal) : bVal.localeCompare(aVal);
            });
            
            rows.forEach(row => table.appendChild(row));
        }
        
        // Initial render
        updateCharts();
    </script>
</body>
</html>